---
id: Become_Verification_Node
title: Upgrade to Validator Node
sidebar_label: Upgrade to Validator Node
---

## Overview

PlatON is a blockchain project that implements democratic governance. Verification nodes are jointly selected by all Energon holders to maintain and develop the PlatON network. The 101 nodes with the most votes will become candidate nodes, from which 25 verification nodes will be randomly selected using VRF to participate in the management of the entire PlatON network.

This section describes how to operate as a verification node.



## *Preparation*

### Before becoming a verification node, please ensure that the server has the following conditions:

- The PlatON node has been installed and the wallet file and node key have been created according to the instructions of` Installing a Node`
- Start the node and join the PlatON network

> This section assumes that the server is Ubuntu 18.04, and the working directory where the executable file is located is ~/platon-node. Note that all subsequent command line operations are performed in the working directory.
>
> If the key is not generated in advance, the node is automatically generated in the node's data directory at startup. If it is automatically generated, only the node private key and BLS private key will be generated, and the relevant public key will not be automatically generated.




## Configure Nginx

For security reasons, it is not recommended to open the rpc port of the node directly (the node server defaults to Ubuntu 18.04).

You can consider using Nginx for reverse proxy, and strengthen the security of Nginx ports through user authentication and HTTPS. If the user changes the node data directory when installing PlatON, the nginx_conf.sh script also needs to be modified to the same node data directory.

### Download nginx_conf.sh

```bash
wget https://7w6qnuo9se.s3.eu-central-1.amazonaws.com/opensource/scripts/nginx_conf.sh
```

or

```bash
wget http://47.91.153.183/opensource/scripts/nginx_conf.sh
```



### Execute the script

```bash
chmod +x nginx_conf.sh && ./nginx_conf.sh
```

> Attention
>
> - When prompted for `[sudo] password for`, enter the current account password.
> - When prompted `Enter your name`: enter your username，When prompted `Enter your password: ` enter your password. Be sure to keep the username and password in mind, and you will need to fill in the MTool configuration to verify the node information.
> - The prompt `ngnix conf succeed` means that nginx is configured successfully. If the configuration is not successful, please contact our customer service to report specific issues.



## Install Mtool

### Download Mtool toolkit

``````bash
wget https://7w6qnuo9se.s3.eu-central-1.amazonaws.com/mtool/0.11.0/mtool-client.zip
``````

or

```bash
wget http://47.91.153.183/mtool/0.11.0/mtool-client.zip
```

### Extract the Mtool toolkit and install

`````bash
(if ! command -v unzip;then sudo apt install unzip; fi;) && unzip mtool-client.zip && cd mtool-client && chmod +x mtool_install.sh && ./mtool_install.sh
`````



## Configure Mtool

### Generate wallet

To participate in the verification node to produce blocks, two wallets must be created. If you already have a wallet, you can skip this step by copying the wallet file to the `$MTOOLDIR/keystore` directory.

- Pledge wallet: The pledge wallet is used to pledge tokens. To become a candidate node, you must pledged successfully. Run the following command to create a pledged wallet

```bash
mtool-client account new staking
```

Enter the password once and confirm the password again to create a wallet file. After the creation is successful, a pledged wallet file `staking.json` will be generated in the directory` $MTOOLDIR/keystore`.

- Earnings wallet: It is used to collect block rewards and Staking rewards. Staking rewards are uniformly distributed to verification nodes, which are distributed by the verification nodes themselves. Run the following command to create a revenue wallet

```bash
mtool-client account new reward
```

Enter the password once and confirm the password again to create the wallet file. After the creation is successful, the pledge wallet file `reward.json` will be generated in the directory` $MTOOLDIR/keystore`.



### Configure verification node information

#### Download the script

```bash
cd $MTOOLDIR && wget https://7w6qnuo9se.s3.eu-central-1.amazonaws.com/opensource/scripts/validator_conf.sh
```

or

```bash
cd $MTOOLDIR && wget http://47.91.153.183/opensource/scripts/validator_conf.sh
```



#### Run the script configuration

```bash
$ chmod +x validator_conf.sh && ./validator_conf.sh
```

> **Attention:**
>
> - When  prompt "Please enter the platon node IP address:", Please enter the PlatON node server ip address.
> - When  prompt "Please enter the platon chain id:", Please enter the chain ID, and select it according to whether the connected network is the main network or test network (test network: 101).
> - When  prompt "Please enter the delegatedRewardRate(0~10000):", Please enter the proportion of dividends, ranging from 0 to 10000, in units (ten thousandths of a percentage). For example, if you enter 5000, it means that the proportion of dividends is 50%.
> - When  prompt "Enter your name:", Please enter the username when configuring PlatON node.
> - When  prompt "Enter your password:", Please enter the password when configuring PlatON node.
> - When  prompt "Enter your platon node name:", Please enter the name of the PlatON node.
> - When  prompt "Enter your platon node description:", Please enter PlatON node description.
> - When  prompt "validator conf success", And when the validator_config.json content printed at the end is normal, it means that the script is executed successfully. If the script is not executed successfully, please contact our official customer service to feedback specific questions.



#### Verify node information configuration file description

After the configuration of the verification node information is completed, the verification node information file validator_config.json will be generated in the validator subdirectory of the MTool installation directory. The file content is as follows:

```json
{
  "chainId": "101",
  "delegatedRewardRate": "5000",
  "nodePublicKey": "79ca603ef75d5954ec270802fa4e7b9bf045842bb7f3e95b849173f61d8a7cfef82b8687abef67f29645e068ff371da514f32b009b05f48062daa84f0b58ab6d",
  "blsPubKey": "a2e1c2e60eb8bb2af05fff4d07c8fce7c408fbe944be1a58194d9e9c9078cb7bb55b63311c8af107453ac182eef22a04cb9ff28cc3367f1e8459f8dcbe9f5c965a6f377f9ff9bb39a78e4e04fd27876137bb0a9aa4066d0277464f018e989e94",
  "benefitAddress": "0x32bec384344c2dc1ea794a4e149c1b74dd8467ef",
  "nodeAddress": "https://test:test@domain3",
  "nodePort": "16789",
  "nodeRpcPort": "443",
  "nodeName": "water-node",
  "details": "this is water-node",
  "externalId": "MyKeyBaseId",
  "webSite": "http://www.mycompany.com",
  "certificate": "C:/tools/mtool/current/ca.crt"
}
```

> **Parameter description:**
>
> - chainId: The chain of Bailey World is 101.
> - delegatedRewardRate: Used to set the proportion of dividends to the client.
> - nodePublicKey: Node ID, which can be viewed in the nodeid file under the node data directory data
> - blsPubKey: BLS public key, which can be viewed in the blspub file under the node data directory data.
> - benefitAddress: Revenue wallet address.
> - nodeAddress:
>   - If you use Nginx, you need to use ** https ** protocol, the format is: `https://test:test@domain3`.
>   - If you do not use Nginx, you need to use the ** http ** protocol. If MTool and the node are on the same machine or in the same local area network, you can use the intranet IP, otherwise use the public IP, the format is: `http://18.238.183.12`.
> - nodePort: Node P2P port, default is 16789.
> - nodeRpcPort:
>   - If Nginx is used, the port defaults to 443.
>   - If Nginx is not used, the port defaults to 6789.
> - nodeName: Node name.
> - details: Node description.
> - externalId: Correspond to the avatar displayed by the browser, you can register on the official website of [keybase.io](https://keybase.io/). The corresponding value is: Register an account and generate a 16-bit public key.
> - webSite: Company website。
> - certificate: ca certificate address, this parameter can be deleted if Nginx reverse proxy is not used.



## Initiate a pledge operation

If the consensus node deployment is complete and the synchronization block has been successfully completed, you can use MTool for pledge operations. After the pledge fund application is completed, ensure that the balance of the pledge account is sufficient, and replace the pledge amount according to the user's situation. The minimum threshold for pledge is 1 million LAT.

Attention: Please keep enough LAT in the pledged account, so that the transactions initiated by the subsequent node management have sufficient transaction fees, such as voting for upgrade proposals, and unsecured transactions.

- Excuting command:

````bash
mtool-client staking --amount 1000000 --keystore $MTOOLDIR/keystore/staking.json --config $MTOOLDIR/validator/validator_config.json
````

Enter the password of the pledge wallet and press Enter. If the following information is displayed, the pledge is successful:

```bash
operation finished
transaction hash:
0x89b964d27d0caf1d8bf268f721eb123c4af57aed36187bea90b262f4769eeb9b
SUCCESS
```

> **Parameter description:**
>
> - amount: Number of pledges，Not less than 1000000lat-pledge threshold, decimal point does not exceed 8 digits.
> - restrictedamount: Not less than 1000000lat-pledge threshold, decimal point does not exceed 8 digits (Pledged with locked balance).

